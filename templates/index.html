<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Quick Deals – Smart Shopping Assistant</title>
    <style>
      :root {
        --primary: #6a11cb;
        --secondary: #2575fc;
        --accent: #ff9800;
        --success: #4caf50;
        --warning: #ff5722;
        --light-bg: #f8f9fa;
        --dark-text: #333;
        --light-text: #fff;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.15);
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }

      * {
        box-sizing: border-box;
      }

      body {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        min-height: 100vh;
        margin: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        color: var(--dark-text);
        overflow-x: hidden;
      }

      .header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        padding: 12px 25px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: var(--shadow);
        z-index: 1000;
        transition: var(--transition);
      }

      .header.small {
        padding: 8px 20px;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
      }

      .logo {
        font-size: 26px;
        font-weight: 700;
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition);
      }

      .header.small .logo {
        font-size: 22px;
      }

      .nav-links {
        display: flex;
        align-items: center;
      }

      .nav-links a {
        color: #444;
        text-decoration: none;
        margin-left: 20px;
        font-weight: 500;
        transition: var(--transition);
        position: relative;
        font-size: 16px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .header.small .nav-links a {
        font-size: 14px;
        margin-left: 15px;
      }

      .nav-links a:hover {
        color: var(--primary);
      }

      .nav-links a::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--primary);
        transition: var(--transition);
      }

      .nav-links a:hover::after {
        width: 100%;
      }

      .cart-count {
        background: var(--accent);
        color: white;
        border-radius: 50%;
        width: 18px;
        height: 18px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        top: -8px;
        right: -8px;
      }

      /* Mobile Navigation */
      .mobile-nav {
        display: none;
        flex-direction: column;
        position: relative;
      }

      .hamburger {
        display: none;
        flex-direction: column;
        cursor: pointer;
        padding: 5px;
        gap: 3px;
      }

      .hamburger span {
        width: 25px;
        height: 3px;
        background: var(--primary);
        border-radius: 2px;
        transition: var(--transition);
      }

      .mobile-nav-slider {
        position: fixed;
        top: 0;
        right: -100%;
        width: 280px;
        height: 100vh;
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        box-shadow: -5px 0 25px rgba(0, 0, 0, 0.2);
        z-index: 2000;
        transition: var(--transition);
        padding: 80px 30px 30px;
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .mobile-nav-slider.active {
        right: 0;
      }

      .mobile-nav-slider a {
        color: white;
        text-decoration: none;
        font-size: 18px;
        font-weight: 500;
        padding: 15px 20px;
        border-radius: 10px;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 12px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        position: relative;
      }

      .mobile-nav-slider a:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(-5px);
      }

      .mobile-nav-slider a i {
        font-size: 20px;
      }

      .close-slider {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 20px;
        transition: var(--transition);
        z-index: 2001;
      }

      .close-slider:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
      }

      /* Offers Container - Fixed Positioning */
      .offers-container {
        position: fixed;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
        z-index: 1500;
        transition: var(--transition);
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 15px;
      }

      .offers-container.hidden {
        opacity: 0;
        visibility: hidden;
        transform: translateY(-50%) translateX(20px);
      }

      .offer-trigger {
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        border: none;
        padding: 15px 20px;
        border-radius: 50px;
        cursor: pointer;
        font-weight: 600;
        box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        transition: var(--bounce);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        position: relative;
        z-index: 1501;
      }

      .offer-trigger:hover {
        transform: translateX(-5px) scale(1.05);
        box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
      }

      .offer-trigger.hidden {
        opacity: 0;
        visibility: hidden;
        transform: translateX(20px);
      }

      .offers-panel {
        position: relative;
        width: 320px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        padding: 25px;
        opacity: 0;
        visibility: hidden;
        transform: translateX(20px);
        transition: var(--transition);
        border: 1px solid rgba(255, 255, 255, 0.3);
        margin-top: 10px;
        max-height: 70vh;
        overflow-y: auto;
        z-index: 1502;
      }

      .offers-panel.active {
        opacity: 1;
        visibility: visible;
        transform: translateX(0);
        animation: slideInOffers 0.5s ease;
      }

      @keyframes slideInOffers {
        from {
          opacity: 0;
          transform: translateX(50px);
        }

        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .offers-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid rgba(255, 107, 107, 0.2);
        position: relative;
        z-index: 1503;
      }

      .offers-header h3 {
        margin: 0;
        color: #ff6b6b;
        font-size: 1.4rem;
        font-weight: 700;
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .close-offers {
        background: rgba(255, 255, 255, 0.95);
        border: none;
        font-size: 24px;
        color: #ff6b6b;
        cursor: pointer;
        transition: var(--transition);
        padding: 8px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1504;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        position: relative;
      }

      .close-offers:hover {
        background: white;
        color: #ff0000;
        transform: rotate(90deg) scale(1.1);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .offer-item {
        background: white;
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 15px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        transition: var(--transition);
        border-left: 4px solid #ffa726;
        position: relative;
        overflow: hidden;
      }

      .offer-item::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 167, 38, 0.1),
          transparent
        );
        transition: var(--transition);
      }

      .offer-item:hover::before {
        left: 100%;
      }

      .offer-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.12);
      }

      .offer-item h4 {
        margin: 0 0 8px 0;
        color: var(--dark-text);
        font-size: 1.1rem;
        font-weight: 600;
      }

      .offer-item p {
        margin: 0;
        color: #666;
        font-size: 0.9rem;
        line-height: 1.4;
      }

      .offer-badge {
        background: linear-gradient(135deg, #ff6b6b, #ffa726);
        color: white;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 0.7rem;
        font-weight: 600;
        margin-left: 8px;
      }

      /* Intro Section */
      .intro {
        text-align: center;
        color: var(--light-text);
        margin: 120px 20px 40px;
        animation: fadeIn 1.2s ease-in-out;
        max-width: 800px;
        transition: var(--transition);
      }

      .intro.hidden {
        opacity: 0;
        transform: translateY(-20px);
        display: none;
      }

      .intro h1 {
        font-size: 2.8rem;
        margin-bottom: 20px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .intro p {
        font-size: 1.2rem;
        line-height: 1.6;
        margin-bottom: 30px;
        opacity: 0.9;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .cta-button {
        background: var(--accent);
        border: none;
        color: var(--light-text);
        padding: 14px 35px;
        border-radius: 30px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .cta-button:hover {
        background: #f57c00;
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4);
      }

      /* Chat Wrapper */
      .chat-wrapper {
        width: 100%;
        height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 80px 20px 20px;
        display: none;
        flex-direction: column;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 999;
        animation: slideUpFull 0.8s ease;
      }

      @keyframes slideUpFull {
        from {
          opacity: 0;
          transform: translateY(100px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .chat-container {
        max-width: 1400px;
        width: 100%;
        height: 100%;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        background: white;
        border-radius: 20px;
        box-shadow: var(--shadow);
        overflow: hidden;
      }

      .chat-header {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 20px 30px;
        text-align: center;
      }

      .chat-header h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
      }

      .chat-main {
        flex: 1;
        display: flex;
        overflow: hidden;
        max-width: 100%;
      }

      .chat-box {
        flex: 1;
        overflow-y: auto;
        padding: 25px;
        display: flex;
        flex-direction: column;
        background: #f8f9fa;
      }

      .bot-message,
      .user-message {
        border-radius: 18px;
        padding: 15px 20px;
        margin: 10px 0;
        max-width: 70%;
        line-height: 1.5;
        animation: fadeIn 0.5s ease;
        position: relative;
        font-size: 16px;
      }

      .bot-message {
        background: white;
        align-self: flex-start;
        border-bottom-left-radius: 5px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border-left: 4px solid var(--primary);
      }

      .user-message {
        background: var(--primary);
        color: var(--light-text);
        align-self: flex-end;
        border-bottom-right-radius: 5px;
        box-shadow: 0 2px 8px rgba(106, 17, 203, 0.3);
      }

      /* Enhanced Products Container with Slide Comparison */
      .products-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin: 20px 0;
        padding: 10px;
        position: relative;
      }

      .product-card {
        flex: 1 1 calc(33.33% - 20px);
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: var(--transition);
        border: 1px solid #eee;
        min-width: 250px;
        position: relative;
        overflow: hidden;
        opacity: 0;
        transform: translateY(20px);
        animation: slideUpProduct 0.6s ease forwards;
      }

      .product-card:nth-child(1) {
        animation-delay: 0.1s;
      }

      .product-card:nth-child(2) {
        animation-delay: 0.2s;
      }

      .product-card:nth-child(3) {
        animation-delay: 0.3s;
      }

      @keyframes slideUpProduct {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .product-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(106, 17, 203, 0.05),
          transparent
        );
        transition: var(--transition);
      }

      .product-card:hover::before {
        left: 100%;
      }

      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .product-card strong {
        color: var(--primary);
        font-size: 1.1rem;
        display: block;
        margin-bottom: 10px;
      }

      .product-feature {
        display: flex;
        justify-content: space-between;
        margin: 8px 0;
        padding: 5px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .feature-name {
        color: #666;
        font-size: 0.9rem;
      }

      .feature-value {
        color: var(--dark-text);
        font-weight: 600;
        font-size: 0.9rem;
      }

      /* Indian Rupee Price Styling */
      .price-inr {
        color: #2e7d32;
        font-weight: 700;
        font-size: 0.95rem;
      }

      .price-inr::before {
        content: "₹";
        margin-right: 2px;
      }

      .product-score {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        text-align: center;
        margin-top: 10px;
      }

      .score-best {
        background: linear-gradient(135deg, #2196f3, #1976d2);
      }

      .score-good {
        background: linear-gradient(135deg, #4caf50, #45a049);
      }

      .score-average {
        background: linear-gradient(135deg, #ff9800, #f57c00);
      }

      .predict-btn {
        display: block;
        margin: 25px auto 10px auto;
        background: var(--secondary);
        color: var(--light-text);
        border: none;
        padding: 14px 35px;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 16px;
      }

      .predict-btn:hover {
        background: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(37, 117, 252, 0.4);
      }

      /* Add to Cart Button */
      .add-to-cart-btn {
        background: linear-gradient(135deg, #ec4899, #8b5cf6);
        /* Pink to purple gradient */
        color: white;
        border: none;
        padding: 12px 15px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        margin-top: 15px;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        box-shadow: 0 4px 10px rgba(76, 175, 80, 0.3);
        position: relative;
        overflow: hidden;
      }

      .add-to-cart-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: var(--transition);
      }

      .add-to-cart-btn:hover::before {
        left: 100%;
      }

      .add-to-cart-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 15px rgba(76, 175, 80, 0.4);
      }

      .add-to-cart-btn:active {
        transform: translateY(0);
      }

      /* Cart Notification */
      .cart-notification {
        position: fixed;
        top: 100px;
        right: 30px;
        background: var(--success);
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        z-index: 2000;
        display: flex;
        align-items: center;
        gap: 10px;
        opacity: 0;
        transform: translateX(100px);
        transition: var(--transition);
      }

      .cart-notification.show {
        opacity: 1;
        transform: translateX(0);
      }

      /* Cart Page */
      .cart-page {
        width: 100%;
        max-width: 1200px;
        margin: 100px auto 40px;
        padding: 0 20px;
        display: none;
      }

      .cart-page.active {
        display: block;
      }

      .cart-header {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: var(--shadow);
        margin-bottom: 30px;
        text-align: center;
      }

      .cart-header h1 {
        margin: 0;
        color: var(--primary);
        font-size: 2.2rem;
      }

      .cart-actions {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        gap: 15px;
      }

      .clear-cart-btn {
        background: var(--warning);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .clear-cart-btn:hover {
        background: #e64a19;
      }

      .back-to-shopping-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .back-to-shopping-btn:hover {
        background: var(--secondary);
      }

      .cart-items {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .cart-item {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: var(--shadow);
        display: flex;
        align-items: center;
        gap: 20px;
        transition: var(--transition);
        position: relative;
      }

      .cart-item:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-hover);
      }

      .cart-item-image {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 10px;
      }

      .cart-item-details {
        flex: 1;
      }

      .cart-item-details h3 {
        margin: 0 0 10px 0;
        color: var(--dark-text);
      }

      .cart-item-platform {
        color: var(--primary);
        font-weight: 600;
        margin-bottom: 10px;
      }

      .cart-item-price {
        color: var(--success);
        font-weight: 700;
        font-size: 1.2rem;
        margin: 10px 0;
      }

      .cart-item-price::before {
        content: "₹";
      }

      .cart-item-specs {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 10px;
        margin: 15px 0;
      }

      .cart-item-spec {
        display: flex;
        justify-content: space-between;
        padding: 5px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .spec-name {
        color: #666;
        font-size: 0.9rem;
      }

      .spec-value {
        color: var(--dark-text);
        font-weight: 600;
        font-size: 0.9rem;
      }

      .cart-item-quantity {
        display: flex;
        align-items: center;
        gap: 10px;
        margin: 10px 0;
      }

      .quantity-btn {
        background: var(--light-bg);
        border: none;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition);
      }

      .quantity-btn:hover {
        background: var(--primary);
        color: white;
      }

      .cart-item-actions {
        display: flex;
        gap: 10px;
        flex-direction: column;
      }

      .remove-from-cart {
        background: var(--warning);
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 6px;
        cursor: pointer;
        transition: var(--transition);
      }

      .remove-from-cart:hover {
        background: #e64a19;
      }

      .buy-now-btn {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
      }

      .buy-now-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(37, 117, 252, 0.3);
      }

      .cart-total {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: var(--shadow);
        margin-top: 30px;
        text-align: center;
      }

      .cart-total h2 {
        margin: 0 0 15px 0;
        color: var(--dark-text);
      }

      .total-amount {
        font-size: 2rem;
        font-weight: 700;
        color: var(--success);
        margin-bottom: 20px;
      }

      .total-amount::before {
        content: "₹";
      }

      .checkout-btn {
        background: var(--primary);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        width: 100%;
        max-width: 300px;
      }

      .checkout-btn:hover {
        background: var(--secondary);
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(37, 117, 252, 0.4);
      }

      .empty-cart {
        text-align: center;
        padding: 50px 20px;
        background: white;
        border-radius: 15px;
        box-shadow: var(--shadow);
      }

      .empty-cart h2 {
        color: var(--dark-text);
        margin-bottom: 20px;
      }

      .back-to-shopping {
        background: var(--primary);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }

      .back-to-shopping:hover {
        background: var(--secondary);
        transform: translateY(-2px);
      }

      /* Payment Modal */
      .payment-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(5px);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 3000;
        opacity: 0;
        transition: var(--transition);
      }

      .payment-modal.active {
        display: flex;
        opacity: 1;
      }

      .payment-container {
        background: white;
        border-radius: 20px;
        padding: 30px;
        max-width: 500px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        transform: scale(0.9);
        transition: var(--transition);
      }

      .payment-modal.active .payment-container {
        transform: scale(1);
      }

      .payment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
      }

      .payment-header h2 {
        margin: 0;
        color: var(--primary);
        font-size: 1.5rem;
      }

      .close-payment {
        background: none;
        border: none;
        font-size: 24px;
        color: #666;
        cursor: pointer;
        transition: var(--transition);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close-payment:hover {
        background: #f0f0f0;
        color: var(--primary);
      }

      .payment-product-info {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
      }

      .payment-product-info h3 {
        margin: 0 0 10px 0;
        color: var(--dark-text);
      }

      .payment-form {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .form-group {
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .form-group label {
        font-weight: 600;
        color: var(--dark-text);
      }

      .form-group input,
      .form-group select {
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 16px;
        transition: var(--transition);
      }

      .form-group input:focus,
      .form-group select:focus {
        border-color: var(--primary);
        outline: none;
        box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1);
      }

      .payment-methods {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin: 15px 0;
      }

      .payment-method {
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
      }

      .payment-method:hover {
        border-color: var(--primary);
        background: #f8f9fa;
      }

      .payment-method.selected {
        border-color: var(--primary);
        background: rgba(106, 17, 203, 0.05);
      }

      .payment-method-icon {
        font-size: 24px;
      }

      .payment-method-name {
        font-weight: 600;
        color: var(--dark-text);
      }

      .pay-now-btn {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        padding: 15px;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: var(--transition);
        margin-top: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .pay-now-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(37, 117, 252, 0.4);
      }

      /* Coming Soon Message */
      .coming-soon-message {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 20px 30px;
        border-radius: 10px;
        z-index: 3000;
        text-align: center;
        opacity: 0;
        visibility: hidden;
        transition: var(--transition);
      }

      .coming-soon-message.show {
        opacity: 1;
        visibility: visible;
      }

      /* Chat Form */
      .chat-form {
        display: flex;
        padding: 12px 15px;
        background: white;
        border-top: 1px solid #eee;
        gap: 10px;
        align-items: center;
        position: relative;
      }

      .input-container {
        position: relative;
        flex: 1;
        display: flex;
      }

      #user-input {
        width: 100%;
        padding: 12px 50px 12px 25px;
        border: 2px solid #e0e0e0;
        border-radius: 30px;
        font-size: 15px;
        transition: var(--bounce);
        background: linear-gradient(135deg, #f8f9fa, #ffffff);
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05),
          0 2px 8px rgba(0, 0, 0, 0.05);
        outline: none;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      #user-input:focus {
        border-color: var(--primary);
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        box-shadow: inset 0 2px 8px rgba(106, 17, 203, 0.1),
          0 4px 20px rgba(106, 17, 203, 0.15);
        transform: translateY(-2px);
        padding-left: 30px;
      }

      #user-input::placeholder {
        color: #9e9e9e;
        transition: var(--transition);
      }

      #user-input:focus::placeholder {
        color: #bdbdbd;
        transform: translateX(5px);
      }

      .input-icon {
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        color: #9e9e9e;
        transition: var(--transition);
        pointer-events: none;
      }

      #user-input:focus ~ .input-icon {
        color: var(--primary);
        transform: translateY(-50%) scale(1.1);
      }

      .input-label {
        position: absolute;
        left: 25px;
        top: 50%;
        transform: translateY(-50%);
        color: #9e9e9e;
        font-size: 15px;
        pointer-events: none;
        transition: var(--bounce);
        background: white;
        padding: 0 8px;
      }

      #user-input:focus ~ .input-label,
      #user-input:not(:placeholder-shown) ~ .input-label {
        top: 0;
        font-size: 12px;
        color: var(--primary);
        font-weight: 600;
        transform: translateY(-50%);
      }

      .send-button {
        background: linear-gradient(135deg, var(--secondary), var(--primary));
        color: var(--light-text);
        border: none;
        padding: 12px 22px;
        border-radius: 30px;
        font-weight: 600;
        cursor: pointer;
        transition: var(--bounce);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 15px;
        box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3),
          inset 0 1px 0 rgba(255, 255, 255, 0.2);
        position: relative;
        overflow: hidden;
      }

      .send-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: var(--transition);
      }

      .send-button:hover::before {
        left: 100%;
      }

      .send-button:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 8px 25px rgba(37, 117, 252, 0.4),
          inset 0 1px 0 rgba(255, 255, 255, 0.2);
      }

      .send-button:active {
        transform: translateY(-1px) scale(1.02);
        transition: all 0.1s ease;
      }

      .send-button .send-text {
        display: block;
        transition: var(--transition);
      }

      .send-button .send-icon {
        font-size: 1.3rem;
        display: block;
        transition: var(--transition);
      }

      .send-button:hover .send-icon {
        transform: translateX(3px) scale(1.1);
      }

      .send-button:disabled {
        opacity: 0.6;
        transform: none;
        cursor: not-allowed;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .send-button:disabled:hover {
        transform: none;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      /* Loading animation */
      .send-button.loading {
        pointer-events: none;
      }

      .send-button.loading .send-text {
        opacity: 0;
      }

      .send-button.loading::after {
        content: "";
        position: absolute;
        width: 20px;
        height: 20px;
        border: 2px solid transparent;
        border-top: 2px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      /* Micro-interactions */
      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(37, 117, 252, 0.4);
        }

        70% {
          box-shadow: 0 0 0 10px rgba(37, 117, 252, 0);
        }

        100% {
          box-shadow: 0 0 0 0 rgba(37, 117, 252, 0);
        }
      }

      .send-button.pulse {
        animation: pulse 2s infinite;
      }

      .send-button.success {
        background: linear-gradient(135deg, var(--success), #45a049);
        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
      }

      .send-button.success .send-icon {
        transform: scale(1.2);
      }

      /* Price Prediction Button */
      .predict-button {
        display: block;
        width: 100%;
        padding: 12px;
        font-size: 1rem;
        font-weight: 600;
        color: var(--light-text);
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        border: none;
        border-radius: 8px;
        margin-top: 20px;
        cursor: pointer;
        transition: var(--transition);
        box-shadow: 0 4px 15px rgba(106, 17, 203, 0.3);
      }

      .predict-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(106, 17, 203, 0.4);
      }

      .predict-button:disabled {
        background: #999;
        cursor: not-allowed;
        opacity: 0.7;
      }

      .loading {
        opacity: 0.7;
        pointer-events: none;
      }

      .close-chat {
        position: absolute;
        top: 25px;
        right: 25px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: var(--transition);
        font-size: 20px;
        z-index: 1001;
      }

      .close-chat:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
      }

      /* Scrollbar styling */
      .chat-box::-webkit-scrollbar {
        width: 8px;
      }

      .chat-box::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }

      .chat-box::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 10px;
      }

      .chat-box::-webkit-scrollbar-thumb:hover {
        background: var(--secondary);
      }

      .offers-panel::-webkit-scrollbar {
        width: 6px;
      }

      .offers-panel::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }

      .offers-panel::-webkit-scrollbar-thumb {
        background: var(--primary);
        border-radius: 10px;
      }

      /* Indian Currency Formatting in Offers */
      .offer-price {
        color: #2e7d32;
        font-weight: 700;
        margin-top: 5px;
      }

      .offer-price::before {
        content: "₹";
        margin-right: 2px;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .nav-links {
          display: none;
        }

        .mobile-nav {
          display: flex;
        }

        .hamburger {
          display: flex;
        }

        .intro h1 {
          font-size: 2.2rem;
        }

        .intro p {
          font-size: 1rem;
        }

        .product-card {
          flex: 1 1 100%;
        }

        .header {
          padding: 10px 15px;
        }

        .chat-wrapper {
          padding: 70px 10px 10px;
        }

        .chat-container {
          border-radius: 15px;
        }

        .bot-message,
        .user-message {
          max-width: 85%;
          font-size: 14px;
          padding: 12px 16px;
        }

        /* Reduced height for form on mobile */
        .chat-form {
          padding: 10px 10px;
          gap: 8px;
        }

        #user-input {
          padding: 10px 45px 10px 20px;
          font-size: 14px;
        }

        .send-button {
          padding: 10px 12px;
          font-size: 14px;
        }

        .send-button .send-text {
          display: none;
        }

        .input-label {
          left: 20px;
          font-size: 14px;
        }

        #user-input:focus ~ .input-label,
        #user-input:not(:placeholder-shown) ~ .input-label {
          font-size: 11px;
        }

        .offers-container {
          right: 10px;
        }

        .offers-panel {
          width: 280px;
          max-height: 60vh;
        }

        .offer-trigger {
          padding: 12px 16px;
          font-size: 12px;
        }

        .cart-item {
          flex-direction: column;
          text-align: center;
        }

        .cart-item-image {
          width: 100%;
          max-width: 200px;
          height: auto;
        }

        .cart-notification {
          top: 80px;
          right: 15px;
          left: 15px;
        }

        .cart-actions {
          flex-direction: column;
        }

        .cart-item-specs {
          grid-template-columns: 1fr;
        }

        .payment-methods {
          grid-template-columns: 1fr;
        }

        .payment-container {
          padding: 20px;
          margin: 20px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Payment Modal -->
    <div class="payment-modal" id="paymentModal">
      <div class="payment-container">
        <div class="payment-header">
          <h2>Complete Your Purchase</h2>
          <button class="close-payment" onclick="closePaymentModal()">×</button>
        </div>

        <div class="payment-product-info" id="paymentProductInfo">
          <!-- Product info will be dynamically inserted here -->
        </div>

        <form class="payment-form" id="paymentForm">
          <div class="form-group">
            <label for="customerEmail">Email Address</label>
            <input
              type="email"
              id="customerEmail"
              placeholder="your@email.com"
              required
            />
          </div>

          <div class="form-group">
            <label for="customerPhone">Phone Number</label>
            <input
              type="tel"
              id="customerPhone"
              placeholder="+91 98765 43210"
              required
            />
          </div>

          <div class="form-group">
            <label>Select Payment Method</label>
            <div class="payment-methods">
              <div
                class="payment-method"
                data-method="gpay"
                onclick="selectPaymentMethod('gpay')"
              >
                <div class="payment-method-icon">📱</div>
                <div class="payment-method-name">Google Pay</div>
              </div>
              <div
                class="payment-method"
                data-method="credit"
                onclick="selectPaymentMethod('credit')"
              >
                <div class="payment-method-icon">💳</div>
                <div class="payment-method-name">Credit Card</div>
              </div>
              <div
                class="payment-method"
                data-method="debit"
                onclick="selectPaymentMethod('debit')"
              >
                <div class="payment-method-icon">💳</div>
                <div class="payment-method-name">Debit Card</div>
              </div>
              <div
                class="payment-method"
                data-method="paytm"
                onclick="selectPaymentMethod('paytm')"
              >
                <div class="payment-method-icon">💰</div>
                <div class="payment-method-name">Paytm</div>
              </div>
            </div>
          </div>

          <div id="cardDetails" class="form-group" style="display: none">
            <label for="cardNumber">Card Number</label>
            <input
              type="text"
              id="cardNumber"
              placeholder="1234 5678 9012 3456"
            />

            <div style="display: flex; gap: 10px; margin-top: 10px">
              <div style="flex: 1">
                <label for="expiryDate">Expiry Date</label>
                <input type="text" id="expiryDate" placeholder="MM/YY" />
              </div>
              <div style="flex: 1">
                <label for="cvv">CVV</label>
                <input type="text" id="cvv" placeholder="123" />
              </div>
            </div>
          </div>

          <button type="button" class="pay-now-btn" onclick="processPayment()">
            💳 Pay Now
          </button>
        </form>
      </div>
    </div>

    <!-- Coming Soon Message -->
    <div class="coming-soon-message" id="comingSoonMessage">
      <h3>🚀 Feature Coming Soon!</h3>
      <p>Price prediction will be available in the next update</p>
    </div>

    <!-- Cart Notification -->
    <div class="cart-notification" id="cartNotification">
      <span>✅</span>
      <span>Product added to cart!</span>
    </div>

    <!-- Offers Container -->
    <div class="offers-container" id="offersContainer">
      <button class="offer-trigger" id="offerTrigger" onclick="toggleOffers()">
        🔥 Hot Offers
      </button>
      <div class="offers-panel" id="offersPanel">
        <div class="offers-header">
          <h3>Latest Offers 🎁</h3>
          <button class="close-offers" onclick="closeOffers()">×</button>
        </div>
        <div class="offers-content">
          <div class="offer-item">
            <h4>Smartphones <span class="offer-badge">60% OFF</span></h4>
            <p>Flagship phones with massive discounts. Limited time offer!</p>
          </div>
          <div class="offer-item">
            <h4>Laptops <span class="offer-badge">45% OFF</span></h4>
            <p>Gaming & Business laptops at unbelievable prices</p>
          </div>
          <div class="offer-item">
            <h4>Headphones <span class="offer-badge">70% OFF</span></h4>
            <p>Premium audio with noise cancellation features</p>
          </div>
          <div class="offer-item">
            <h4>Electronics <span class="offer-badge">55% OFF</span></h4>
            <p>All electronic gadgets with extended warranty</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Header -->
    <div class="header" id="header">
      <div class="logo">Quick Deals 🛒</div>
      <div class="nav-links">
        <a href="#">Offers</a>
        <a href="#">Compare</a>
        <a href="#">Predict</a>
        <a href="#">About</a>
        <a href="#" id="cartLink" onclick="showCartPage()">
          🛒 Cart
          <span class="cart-count" id="cartCount">0</span>
        </a>
      </div>
      <div class="mobile-nav">
        <div class="hamburger" onclick="toggleMobileNav()">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <div class="mobile-nav-slider" id="mobileNavSlider">
          <button class="close-slider" onclick="toggleMobileNav()">×</button>
          <a href="#"><span>🎁</span> Offers</a>
          <a href="#"><span>⚖️</span> Compare</a>
          <a href="#"><span>🔮</span> Predict</a>
          <a href="#"><span>ℹ️</span> About</a>
          <a href="#" onclick="showCartPage()">
            <span>🛒</span> Cart
            <span class="cart-count" id="mobileCartCount">0</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Intro Section -->
    <div class="intro" id="intro">
      <h1>AI-Powered Smart Shopping Assistant</h1>
      <p>
        Type what you're looking for and let Quick Deals find the best offers,
        discounts, and products for you anytime.
      </p>
      <button class="cta-button" onclick="showChat()">Start Now</button>
    </div>

    <!-- Chat Wrapper -->
    <div class="chat-wrapper" id="chat">
      <button class="close-chat" onclick="hideChat()">✕</button>
      <div class="chat-container">
        <div class="chat-main">
          <div id="chat-box" class="chat-box">
            <div class="bot-message">
              👋 Hi there! What product are you looking for today? Phone, Laptop
              or Headphones?
            </div>
          </div>
        </div>
        <form id="chat-form" class="chat-form">
          <div class="input-container">
            <input
              type="text"
              id="user-input"
              placeholder=" "
              autocomplete="off"
            />
            <span class="input-label">Type your message...</span>
            <div class="input-icon">💬</div>
          </div>
          <button type="submit" class="send-button">
            <span class="send-text">Send</span>
            <span class="send-icon">🚀</span>
          </button>
        </form>
      </div>
    </div>

    <!-- Cart Page -->
    <div class="cart-page" id="cartPage">
      <div class="cart-header">
        <h1>Your Shopping Cart</h1>
        <div class="cart-actions">
          <button class="clear-cart-btn" onclick="clearCart()">
            🗑️ Clear Cart
          </button>
          <button class="back-to-shopping-btn" onclick="goBackToShopping()">
            ← Back to Shopping
          </button>
        </div>
      </div>
      <div class="cart-items" id="cartItems">
        <!-- Cart items will be dynamically inserted here -->
      </div>
      <div class="cart-total" id="cartTotal">
        <h2>Total Amount</h2>
        <div class="total-amount" id="totalAmount">0</div>
        <button class="checkout-btn" onclick="checkoutAll()">
          Proceed to Checkout All
        </button>
      </div>
      <div class="empty-cart" id="emptyCart">
        <h2>Your cart is empty</h2>
        <p>Add some products to your cart to see them here</p>
        <button class="back-to-shopping" onclick="goBackToShopping()">
          <span>←</span> Back to Shopping
        </button>
      </div>
    </div>

    <script>
      // --- PART 1: CART FUNCTIONALITY ---

      // Initialize cart from localStorage or create empty array
      let cart = JSON.parse(localStorage.getItem("quickDealsCart")) || [];
      let selectedPaymentMethod = "";

      // Function to update cart count in UI
      function updateCartCount() {
        const cartCount = document.getElementById("cartCount");
        const mobileCartCount = document.getElementById("mobileCartCount");

        if (cartCount) cartCount.textContent = cart.length;
        if (mobileCartCount) mobileCartCount.textContent = cart.length;
      }

      // Function to show cart notification
      function showCartNotification() {
        const notification = document.getElementById("cartNotification");
        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 2000);
      }

      // Function to convert score to text rating (NO FLOAT VALUES)
      function getScoreRating(score) {
        // Simple rating system - only Best, Good, or Average
        if (score >= 8.5) return { text: "Best", class: "score-best" };
        if (score >= 7) return { text: "Good", class: "score-good" };
        return { text: "Average", class: "score-average" };
      }

      // Function to add product to cart

      function addToCart(product) {
        // Check if product already exists in cart
        const existingProductIndex = cart.findIndex(
          (item) =>
            item.platform === product.platform && item.name === product.name
        );

        if (existingProductIndex === -1) {
          // Add product to cart with quantity 1 and image
          cart.push({
            ...product,
            image: product.image || product.base_image_url, // Store image URL
            quantity: 1,
            addedAt: new Date().toISOString(),
          });

          // Save to localStorage
          localStorage.setItem("quickDealsCart", JSON.stringify(cart));

          // Update UI
          updateCartCount();
          showCartNotification();

          console.log("Product added to cart:", product);
        } else {
          // If product already exists, increase quantity
          cart[existingProductIndex].quantity += 1;
          localStorage.setItem("quickDealsCart", JSON.stringify(cart));
          updateCartCount();
          showCartNotification();
        }
      }

      // Function to remove product from cart
      function removeFromCart(index) {
        cart.splice(index, 1);
        localStorage.setItem("quickDealsCart", JSON.stringify(cart));
        updateCartCount();
        renderCartItems();
      }

      // Function to update product quantity
      function updateQuantity(index, change) {
        const newQuantity = cart[index].quantity + change;
        if (newQuantity > 0) {
          cart[index].quantity = newQuantity;
          localStorage.setItem("quickDealsCart", JSON.stringify(cart));
          updateCartCount();
          renderCartItems();
        }
      }

      // Function to clear entire cart
      function clearCart() {
        if (cart.length === 0) return;

        if (confirm("Are you sure you want to clear your cart?")) {
          cart = [];
          localStorage.setItem("quickDealsCart", JSON.stringify(cart));
          updateCartCount();
          renderCartItems();
        }
      }

      // Function to render cart items
      // Function to render cart items
      function renderCartItems() {
        const cartItems = document.getElementById("cartItems");
        const emptyCart = document.getElementById("emptyCart");
        const cartTotal = document.getElementById("cartTotal");
        const totalAmount = document.getElementById("totalAmount");

        if (cart.length === 0) {
          emptyCart.style.display = "block";
          cartTotal.style.display = "none";
          cartItems.innerHTML = "";
          return;
        }

        emptyCart.style.display = "none";
        cartTotal.style.display = "block";

        let total = 0;
        let itemsHTML = "";

        cart.forEach((item, index) => {
          const price = convertToINR(item.price);
          total += price * item.quantity;
          const scoreRating = getScoreRating(item.score);

          // Use stored image or fallback to placeholder
          const productImage =
            item.image ||
            item.base_image_url ||
            "https://via.placeholder.com/120";

          itemsHTML += `
      <div class="cart-item">
<img src="${productImage}" alt="${item.name}" class="cart-item-image" onerror="this.src='https://via.placeholder.com/120'">
        <div class="cart-item-details">
          <h3>${item.name}</h3>
          <div class="cart-item-platform">${item.platform}</div>
          <div class="cart-item-price">${price}</div>
          
          <div class="cart-item-specs">
            <div class="cart-item-spec">
              <span class="spec-name">RAM:</span>
              <span class="spec-value">${item.specs?.RAM || "N/A"}</span>
            </div>
            <div class="cart-item-spec">
              <span class="spec-name">Storage:</span>
              <span class="spec-value">${item.specs?.Storage || "N/A"}</span>
            </div>
            <div class="cart-item-spec">
              <span class="spec-name">Color:</span>
              <span class="spec-value">${item.specs?.Color || "N/A"}</span>
            </div>
            <div class="cart-item-spec">
              <span class="spec-name">Warranty:</span>
              <span class="spec-value">${item.specs?.Warranty || "N/A"}</span>
            </div>
            <div class="cart-item-spec">
              <span class="spec-name">Rating:</span>
              <span class="spec-value">${item.rating} ★</span>
            </div>
            <div class="cart-item-spec">
              <span class="spec-name">Our Score:</span>
              <span class="spec-value ${scoreRating.class}">${
            scoreRating.text
          }</span>
            </div>
          </div>
          
          <div class="cart-item-quantity">
            <span>Quantity:</span>
            <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
            <span>${item.quantity}</span>
            <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
          </div>
        </div>
        <div class="cart-item-actions">
          <button class="buy-now-btn" onclick="buyNow(${index})">
            ⚡ Buy Now
          </button>
          <button class="remove-from-cart" onclick="removeFromCart(${index})">Remove</button>
        </div>
      </div>
    `;
        });

        cartItems.innerHTML = itemsHTML;
        totalAmount.textContent = total.toLocaleString();
      }

      // Function to show cart page
      function showCartPage() {
        const intro = document.getElementById("intro");
        const chat = document.getElementById("chat");
        const cartPage = document.getElementById("cartPage");

        intro.style.display = "none";
        chat.style.display = "none";
        cartPage.classList.add("active");

        renderCartItems();

        // Scroll to top
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      // Function to go back to shopping (chat interface)
      function goBackToShopping() {
        const intro = document.getElementById("intro");
        const chat = document.getElementById("chat");
        const cartPage = document.getElementById("cartPage");

        cartPage.classList.remove("active");
        intro.style.display = "none";
        chat.style.display = "flex";

        // Make sure header is in small mode for chat
        document.getElementById("header").classList.add("small");

        // Hide offers container
        document.getElementById("offersContainer").classList.add("hidden");
      }

      // Function to show payment modal for individual product
      function buyNow(productIndex) {
        const product = cart[productIndex];
        showPaymentModal(product, productIndex);
      }

      // Function to checkout all items
      function checkoutAll() {
        if (cart.length === 0) return;

        // Create a combined product for checkout
        const combinedProduct = {
          name: "Multiple Items",
          platform: "Quick Deals",
          price: cart.reduce(
            (total, item) => total + convertToINR(item.price) * item.quantity,
            0
          ),
          quantity: cart.reduce((total, item) => total + item.quantity, 0),
          items: cart,
        };

        showPaymentModal(combinedProduct, "all");
      }

      // Function to show payment modal
      function showPaymentModal(product, productIndex) {
        const modal = document.getElementById("paymentModal");
        const productInfo = document.getElementById("paymentProductInfo");

        // Set product info
        if (productIndex === "all") {
          productInfo.innerHTML = `
        <h3>Complete Purchase</h3>
        <p>Total Items: ${product.quantity}</p>
        <p>Total Amount: ₹${product.price.toLocaleString()}</p>
        <p>Items: ${product.items
          .map((item) => `${item.name} (${item.platform})`)
          .join(", ")}</p>
      `;
        } else {
          productInfo.innerHTML = `
        <h3>${product.name}</h3>
        <p>Platform: ${product.platform}</p>
        <p>Price: ₹${convertToINR(product.price).toLocaleString()}</p>
        <p>Quantity: ${product.quantity}</p>
      `;
        }

        // Reset form
        document.getElementById("paymentForm").reset();
        document.getElementById("cardDetails").style.display = "none";
        selectedPaymentMethod = "";

        // Remove selected class from all payment methods
        document.querySelectorAll(".payment-method").forEach((method) => {
          method.classList.remove("selected");
        });

        // Show modal
        modal.classList.add("active");
      }

      // Function to close payment modal
      function closePaymentModal() {
        const modal = document.getElementById("paymentModal");
        modal.classList.remove("active");
      }

      // Function to select payment method
      function selectPaymentMethod(method) {
        selectedPaymentMethod = method;

        // Update UI
        document.querySelectorAll(".payment-method").forEach((m) => {
          m.classList.remove("selected");
        });
        document
          .querySelector(`.payment-method[data-method="${method}"]`)
          .classList.add("selected");

        // Show/hide card details
        const cardDetails = document.getElementById("cardDetails");
        if (method === "credit" || method === "debit") {
          cardDetails.style.display = "block";
        } else {
          cardDetails.style.display = "none";
        }
      }

      // Function to process payment
      function processPayment() {
        const email = document.getElementById("customerEmail").value;
        const phone = document.getElementById("customerPhone").value;

        if (!email || !phone) {
          alert("Please fill in all required fields");
          return;
        }

        if (!selectedPaymentMethod) {
          alert("Please select a payment method");
          return;
        }

        if (
          (selectedPaymentMethod === "credit" ||
            selectedPaymentMethod === "debit") &&
          (!document.getElementById("cardNumber").value ||
            !document.getElementById("expiryDate").value ||
            !document.getElementById("cvv").value)
        ) {
          alert("Please fill in all card details");
          return;
        }

        // Simulate payment processing
        alert(
          `Payment processed successfully!\n\nEmail: ${email}\nPhone: ${phone}\nPayment Method: ${selectedPaymentMethod}\n\nThank you for your purchase!`
        );

        // Close modal
        closePaymentModal();

        // Clear cart if it was a full checkout
        if (
          document
            .getElementById("paymentProductInfo")
            .textContent.includes("Multiple Items")
        ) {
          cart = [];
          localStorage.setItem("quickDealsCart", JSON.stringify(cart));
          updateCartCount();
          renderCartItems();
        }
      }

      // Function to show coming soon message
      function showComingSoon() {
        const message = document.getElementById("comingSoonMessage");
        message.classList.add("show");

        setTimeout(() => {
          message.classList.remove("show");
        }, 3000);
      }

      // Initialize cart count on page load
      document.addEventListener("DOMContentLoaded", function () {
        updateCartCount();
      });

      // --- PART 2: UI FUNCTIONS (from your file) ---

      // Mobile Navigation
      function toggleMobileNav() {
        const slider = document.getElementById("mobileNavSlider");
        slider.classList.toggle("active");
      }

      // Offers Panel
      function toggleOffers() {
        const panel = document.getElementById("offersPanel");
        const trigger = document.getElementById("offerTrigger");

        if (panel.classList.contains("active")) {
          panel.classList.remove("active");
          trigger.classList.remove("hidden");
        } else {
          panel.classList.add("active");
          trigger.classList.add("hidden");
        }
      }

      function closeOffers() {
        const panel = document.getElementById("offersPanel");
        const trigger = document.getElementById("offerTrigger");

        panel.classList.remove("active");
        trigger.classList.remove("hidden");
      }

      // Auto-show offers on page load
      document.addEventListener("DOMContentLoaded", function () {
        // Show offers panel automatically after 2 seconds
        setTimeout(() => {
          const panel = document.getElementById("offersPanel");
          const trigger = document.getElementById("offerTrigger");

          panel.classList.add("active");
          trigger.classList.add("hidden");

          // Auto-hide after 8 seconds
          setTimeout(() => {
            panel.classList.remove("active");
            trigger.classList.remove("hidden");
          }, 8000);
        }, 2000);
      });

      // Close offers when clicking outside
      document.addEventListener("click", function (event) {
        const panel = document.getElementById("offersPanel");
        const trigger = document.getElementById("offerTrigger");
        const container = document.getElementById("offersContainer");

        // Check if the click is outside the offers container
        if (container && !container.contains(event.target)) {
          panel.classList.remove("active");
          trigger.classList.remove("hidden");
        }
      });

      // Chat Visibility Functions
      function showChat() {
        const chatWrapper = document.getElementById("chat");
        const intro = document.getElementById("intro");
        const header = document.getElementById("header");
        const offersContainer = document.getElementById("offersContainer");
        const cartPage = document.getElementById("cartPage");

        // Hide intro section with animation
        intro.classList.add("hidden");

        // Hide cart page if active
        cartPage.classList.remove("active");

        // Hide offers container
        offersContainer.classList.add("hidden");

        // Make header smaller
        header.classList.add("small");

        // Show full-screen chat
        chatWrapper.style.display = "flex";

        // Focus on input field with slight delay for smooth animation
        setTimeout(() => {
          document.getElementById("user-input").focus();
        }, 500);
      }

      function hideChat() {
        const chatWrapper = document.getElementById("chat");
        const intro = document.getElementById("intro");
        const header = document.getElementById("header");
        const offersContainer = document.getElementById("offersContainer");

        // Hide chat
        chatWrapper.style.display = "none";

        // Show intro section
        intro.classList.remove("hidden");

        // Show offers container
        offersContainer.classList.remove("hidden");

        // Restore header size
        header.classList.remove("small");

        // Scroll to top
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      // --- PART 3: CHATBOT LOGIC (The correct, merged version) ---

      // Get all chat elements
      const chatBox = document.getElementById("chat-box");
      const chatForm = document.getElementById("chat-form");
      const userInput = document.getElementById("user-input");
      const sendButton = document.querySelector(".send-button"); // Use querySelector for class

      /**
       * (FIXED) Helper functions to format currency
       */
      function formatINR(number) {
        // This is the clean way to format INR
        return new Intl.NumberFormat("en-IN", {
          style: "currency",
          currency: "INR",
          maximumFractionDigits: 0,
        }).format(number);
      }

      function convertToINR(priceStr) {
        // This function just cleans the string (e.g., "₹79,999" -> 79999)
        // It does NOT multiply by 87.
        if (typeof priceStr === "number") return priceStr;
        return Number(String(priceStr).replace(/[^\d.]/g, ""));
      }

      /**
       * Main function to handle form submission
       */
      /**
       * Main function to handle form submission
       */
      chatForm.addEventListener("submit", async function (e) {
        e.preventDefault();
        const message = userInput.value.trim().toLowerCase();
        if (!message) return;

        // Add user's message to chat
        addMessage("user", message);
        userInput.value = "";
        sendButton.classList.add("pulse");
        addTypingIndicator();

        try {
          // Check if the message contains "laptop" and show MacBook comparison
          if (message.includes("laptop")) {
            removeTypingIndicator();

            // Create mock MacBook data
            const macBookData = {
              image:
                "https://store.storeimages.cdn-apple.com/4982/as-images.apple.com/is/macbook-air-spacegray-select-20220606?wid=904&hei=840&fmt=jpeg&qlt=90&.v=1653084303665",
              description:
                "Apple MacBook Air with M2 chip - Powerful performance in a lightweight design",
              products: [
                {
                  platform: "Apple Store",
                  price: "₹1,14,900",
                  specs: {
                    RAM: "8GB",
                    Storage: "256GB SSD",
                    Color: "Space Gray",
                    Warranty: "1 Year",
                    Replaceable: "No",
                    Display: "13.6-inch Liquid Retina",
                  },
                  rating: "4.8",
                  is_trusted: true,
                },
                {
                  platform: "Amazon",
                  price: "₹1,12,999",
                  specs: {
                    RAM: "8GB",
                    Storage: "256GB SSD",
                    Color: "Silver",
                    Warranty: "1 Year",
                    Replaceable: "No",
                    Display: "13.6-inch Liquid Retina",
                  },
                  rating: "4.7",
                  is_trusted: true,
                },
                {
                  platform: "Flipkart",
                  price: "₹1,13,499",
                  specs: {
                    RAM: "8GB",
                    Storage: "256GB SSD",
                    Color: "Starlight",
                    Warranty: "1 Year",
                    Replaceable: "No",
                    Display: "13.6-inch Liquid Retina",
                  },
                  rating: "4.6",
                  is_trusted: true,
                },
              ],
            };

            addMessage(
              "bot",
              "Here are the best MacBook options I found for you:"
            );
            renderProductComparison(macBookData);
            return;
          }

          // Send message to the FastAPI backend for other queries
          const response = await fetch("/chat", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              message: message,
            }),
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();

          removeTypingIndicator();
          addMessage("bot", data.bot); // Add the bot's text response

          // Check if the server sent back product data
          if (data.products && data.products.length > 0) {
            // 1. Call the function to render the main product comparison
            renderProductComparison(data);
          }
        } catch (error) {
          removeTypingIndicator();
          console.error("Error fetching chat response:", error);
          addMessage("bot", "❌ Sorry, I hit an error. Please try again.");
        }
      });
      /**
       * Generic function to add a message to the chat box
       */
      function addMessage(sender, text) {
        const messageDiv = document.createElement("div");
        messageDiv.className = `${sender}-message`;
        // Basic markdown for bot messages (bold)
        if (sender === "bot") {
          text = text.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");
        }
        messageDiv.innerHTML = text;
        chatBox.appendChild(messageDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      /**
       * Adds the "..." typing indicator
       */
      function addTypingIndicator() {
        if (document.getElementById("typing-indicator")) return;
        const typingDiv = document.createElement("div");
        typingDiv.className = "bot-message";
        typingDiv.id = "typing-indicator";
        typingDiv.innerHTML =
          '<div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>';
        chatBox.appendChild(typingDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      /**
       * Removes the "..." typing indicator
       */
      function removeTypingIndicator() {
        const indicator = document.getElementById("typing-indicator");
        if (indicator) {
          indicator.remove();
        }
      }

      /**
       * Renders the main product image, description,
       * and side-by-side comparison cards.
       */
      function renderProductComparison(data) {
        const chatBox = document.getElementById("chat-box");

        // 1. Create the main message container
        const container = document.createElement("div");
        container.className = "bot-message";

        // 2. Add the Product Image and Description with fallback
        let headerHtml = "";

        if (data.image) {
          headerHtml += `<img src="${data.image}" alt="Product" class="product-main-image" style="width: 100%; max-width: 200px; border-radius: 10px; margin-bottom: 15px; display: block; margin-left: auto; margin-right: auto;">`;
        }

        if (data.description) {
          headerHtml += `<p style="margin-bottom: 20px; text-align: center; line-height: 1.5;">${data.description}</p>`;
        }

        // 3. Create the HTML for each of the 3 product cards
        let productsHtml = data.products
          .map((p) => {
            // Generate scores and convert to text ratings (NO FLOAT VALUES)
            const randomScore = Math.random() * 3 + 7; // Scores between 7.0 and 10.0
            const scoreRating = getScoreRating(randomScore);

            // Build the list of specifications from the 'specs' object
            let specsHtml = `
      <div class="product-feature">
        <span class="feature-name">RAM</span>
        <span class="feature-value">${p.specs.RAM || "N/A"}</span>
      </div>
      <div class="product-feature">
        <span class="feature-name">Storage</span>
        <span class="feature-value">${p.specs.Storage || "N/A"}</span>
      </div>
      <div class="product-feature">
        <span class="feature-name">Color</span>
        <span class="feature-value">${p.specs.Color || "N/A"}</span>
      </div>
      <div class="product-feature">
        <span class="feature-name">Warranty</span>
        <span class="feature-value">${p.specs.Warranty || "N/A"}</span>
      </div>
    `;

            // Add additional specs if available
            if (p.specs.Display) {
              specsHtml += `
        <div class="product-feature">
          <span class="feature-name">Display</span>
          <span class="feature-value">${p.specs.Display}</span>
        </div>
      `;
            }
            if (p.specs.Camera) {
              specsHtml += `
        <div class="product-feature">
          <span class="feature-name">Camera</span>
          <span class="feature-value">${p.specs.Camera}</span>
        </div>
      `;
            }
            if (p.specs.Battery) {
              specsHtml += `
        <div class="product-feature">
          <span class="feature-name">Battery</span>
          <span class="feature-value">${p.specs.Battery}</span>
        </div>
      `;
            }

            specsHtml += `
      <div class="product-feature">
        <span class="feature-name">Rating</span>
        <span class="feature-value">${p.rating} ★</span>
      </div>
      <div class="product-feature">
        <span class="feature-name">Trusted Seller</span>
        <span class="feature-value">${p.is_trusted ? "✅ Yes" : "❌ No"}</span>
      </div>
    `;

            // Prepare product data for cart with image
            const cartProductData = {
              ...p,
              score: randomScore,
              image: data.image, // Store the main product image
              name: data.description || p.platform + " Product",
            };

            // Assemble the final card using your .product-card class
            return `
      <div class="product-card">
        <strong>${p.platform}</strong>
        <div class="product-feature">
          <span class="feature-name">Price</span>
          <span class="feature-value price-inr">${p.price.replace(
            /[₹,]/g,
            ""
          )}</span>
        </div>
        ${specsHtml}
        <div class="product-score ${scoreRating.class}">
          Our Score: ${scoreRating.text}
        </div>
        <button class="add-to-cart-btn" onclick="addToCart(${JSON.stringify(
          cartProductData
        ).replace(/"/g, "&quot;")})">
          + Add to Cart
        </button>
      </div>
    `;
          })
          .join("");

        // 4. Combine all the HTML and add it to the chat box
        container.innerHTML = `
    ${headerHtml}
    <div class="products-container">
      ${productsHtml}
    </div>
    
    <button class="predict-button" onclick='showComingSoon()'>
      🔮 Predict Price Drop
    </button>
  `;
        chatBox.appendChild(container);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      /**
       * Enhanced input interactions (from your file)
       */
      userInput.addEventListener("focus", function () {
        sendButton.classList.remove("pulse");
      });

      userInput.addEventListener("input", function () {
        if (this.value.trim()) {
          sendButton.classList.remove("pulse");
        } else {
          sendButton.classList.add("pulse");
        }
      });

      // Allow Enter key to submit form
      userInput.addEventListener("keypress", function (e) {
        if (e.key === "Enter") {
          // Prevent default to avoid line break in input
          e.preventDefault();
          chatForm.dispatchEvent(new Event("submit"));
        }
      });
    </script>
  </body>
</html>
